#ifndef CLINICDAILYREPORT_H
#define CLINICDAILYREPORT_H

#include <QWidget>
#include "stdafx.h"
#include "subform.h"
#include "clinicdailyreporttable.h"


//-----------------------------------------------------------------------------------------------------------------------------------
// 门诊日结界面类
//-----------------------------------------------------------------------------------------------------------------------------------
class ClinicDailyReportFrom : public SubForm
{
    Q_OBJECT
    
public:
    explicit ClinicDailyReportFrom(SubForm *parent = 0);
    ~ClinicDailyReportFrom();
public slots:

    void newTableFile();
    bool saveTableFile();
    bool deleteTableFile();
    void exportTableFile();
    bool findTableFile();
    void amendTableFile();
    void previewTableFile();
    void printTableFile();
protected slots:

    //-----------------------------------------------------------------------------------------------------------------------------------
    // 名称：updateCharges
    // 作用：日期变更的响应事件，新建一个该日期的最新的日结单显示在界面上（为保存）。
    // 参数：无
    // 返回值：无
    // 备注：无
    // 时间：2016-04-27
    //-----------------------------------------------------------------------------------------------------------------------------------
    void updateCharges(QDateTime ReportTime = QDateTime::currentDateTime());

    //-----------------------------------------------------------------------------------------------------------------------------------
    // 名称：updateIncome
    // 作用：根据日结单中收费单列表中的实收应收欠款信息更新合计金额部分的数据
    // 参数：无
    // 返回值：无
    // 备注：无
    // 时间：2016-04-27
    //-----------------------------------------------------------------------------------------------------------------------------------
    void updateIncome();

protected:

    //-----------------------------------------------------------------------------------------------------------------------------------
    // 名称：create
    // 作用：创建门诊日结界面中的控件
    // 参数：无
    // 返回值：无
    // 备注：无
    // 时间：2016-04-27
    //-----------------------------------------------------------------------------------------------------------------------------------
    void create();

    //-----------------------------------------------------------------------------------------------------------------------------------
    // 名称：init
    // 作用：初始化门诊日结界面控件的默认值
    // 参数：无
    // 返回值：无
    // 备注：无
    // 时间：2016-04-27
    //-----------------------------------------------------------------------------------------------------------------------------------
    void init();

    //-----------------------------------------------------------------------------------------------------------------------------------
    // 名称：initTable
    // 作用：初始化门诊日结界面的表格表头等
    // 参数：无
    // 返回值：无
    // 备注：无
    // 时间：2016-04-27
    //-----------------------------------------------------------------------------------------------------------------------------------
    void initTable();

    //-----------------------------------------------------------------------------------------------------------------------------------
    // 名称：setMyLayout
    // 作用：设置门诊日结界面的布局
    // 参数：无
    // 返回值：无
    // 备注：无
    // 时间：2016-04-27
    //-----------------------------------------------------------------------------------------------------------------------------------
    void setMyLayout();

    //-----------------------------------------------------------------------------------------------------------------------------------
    // 名称：setAllDefaultEnable
    // 作用：设置所有的控件为默认状态
    // 参数：无
    // 返回值：
    // 备注：无
    // 时间：2016-04-27
    //-----------------------------------------------------------------------------------------------------------------------------------
    void setAllDefaultEnable();

    //-----------------------------------------------------------------------------------------------------------------------------------
    // 名称：setAllUnEnable
    // 作用：设置所有的控件为不可用状态
    // 参数：无
    // 返回值：
    // 备注：无
    // 时间：2016-04-27
    //-----------------------------------------------------------------------------------------------------------------------------------
    void setAllUnEnable();

    //-----------------------------------------------------------------------------------------------------------------------------------
    // 名称：Read
    // 作用：读取最新的日结信息更新到界面
    // 参数：无
    // 返回值：无
    // 备注：无
    // 时间：2016-04-27
    //-----------------------------------------------------------------------------------------------------------------------------------
    bool Read();

    //-----------------------------------------------------------------------------------------------------------------------------------
    // 名称：Save
    // 作用：保存当前界面的信息生成日结单
    // 参数：无
    // 返回值：无
    // 备注：无
    // 时间：2016-04-27
    //-----------------------------------------------------------------------------------------------------------------------------------
    bool Save();

    //-----------------------------------------------------------------------------------------------------------------------------------
    // 名称：Delete
    // 作用：删除日结单（删除指定日结单，还没实现）
    // 参数：无
    // 返回值：无
    // 备注：无
    // 时间：2016-04-27
    //-----------------------------------------------------------------------------------------------------------------------------------
    bool Delete();

protected:

    //-----------------------------------------------------------------------------------------------------------------------------------
    // 界面
    //-----------------------------------------------------------------------------------------------------------------------------------
    QLabel *m_dailyReportNumLabel;              // 日结单单号
    QLabel *m_dateLabel;                        // 日期
    QLabel *m_allDueIncomeLabel;                // 应收合计
    QLabel *m_allRealIncomeLabel;               // 实收合计
    QLabel *m_allDebtLabel;                     // 欠款合计

    QLineEdit *m_dailyReportNumEdit;            // 日结单单号
    QLineEdit *m_allDueIncomeEdit;              // 应收合计
    QLineEdit *m_allRealIncomeEdit;             // 实收合计
    QLineEdit *m_allDebtEdit;                   // 欠款合计

    QDateEdit *m_dateEdit;                      // 日期
    QTableView *m_dailyChargesView;             // 该日收费记录

    QStandardItemModel *m_dailyChargesModel;    // 该日收费记录

    //-----------------------------------------------------------------------------------------------------------------------------------
    // 数据
    //-----------------------------------------------------------------------------------------------------------------------------------
    ClinicDailyReportTable *m_dailyReportTable; // 日结单
};

#endif // CLINICDAILYREPORT_H
